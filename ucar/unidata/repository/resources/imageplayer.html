

<style>
.imageblock {
        height: 750px; 
	max-height: 750px; 
	overflow-y: auto;
	overflow-x: hidden;
}


.imageplayer {
    background-color:#efefef;
}

</style>


<SCRIPT LANGUAGE="JavaScript">
var icon_blank = "${root}/icons/blank.gif";
var icon_start="${root}/imageplayer/control_play_blue.png";
var icon_stop="${root}/imageplayer/control_pause_blue.png";
var modeNormalImage =  "${root}/imageplayer/button_norm.gif";
var modeRockingImage =  "${root}/imageplayer/button_sweep.gif";



focus()
// <!--
//============================================================
//                >> jsImagePlayer 1.0 <<
//            for Netscape3.0+, September 1996
//============================================================
//                  by (c)BASTaRT 1996
//             Praha, Czech Republic, Europe
//
// feel free to copy and use as long as the credits are given
//          by having this header in the code
//
//          contact: xholecko@sgi.felk.cvut.cz
//          http://sgi.felk.cvut.cz/~xholecko
//
//============================================================
// Thanx to Karel & Martin for beta testing and suggestions!
//============================================================
//
//     modified by D. Watson and A. Earnhart (CIRA/CSU), 7/30/97
//     and Greg Thompson (NCAR/RAP) Dec. 11 1997
//
//============================================================
 
 

var images= new Array();




 
//**************************************************************************
 
//=== global variables ====

//normal_delay = 800;
normal_delay = 1000;
delay = normal_delay;         //delay between frames in 1/100 seconds
delay_step = 100;
delay_max = 6000;
delay_min = 100;
dwell_multipler = 3;
dwell_step = 1;
end_dwell_multipler   = dwell_multipler;
start_dwell_multipler = dwell_multipler;
current_image = 0;
direction =1;
running = 0;
timestamp=1;

function MyImage (url,label) {
   this.url = url;
   this.label = label;
   this.image = null;
   this.ok  =1;
}




function addImage(url,label) {
  images[images.length] =new MyImage(url,label);
  
}

MODE_NORMAL=0;
MODE_NORMAL=1;
MODE_ROCKING=2;
play_mode = 0;                   // 0-normal, 1-loop, 2-sweep
 


image1 = new Image(100,100);
image1.src = icon_stop;
image2 = new Image(100,100);
image2.src = icon_start;
image3 = new Image(100,100);
image3.src = modeNormalImage;
image4 = new Image(100,100);
image4.src = modeRockingImage;


${imagelist}




//==============================================================
//== All previous statements are performed as the page loads. ==
//== The following functions are also defined at this time.   ==
//==============================================================
 
//===> Stop the animation
function startStop() 
{
   if(running==1) {
      stop();
   } else {
      start();
   }
}


function start()
{
   running=1;
   document.startstop.src = icon_stop;
   timestamp++;
   setTimeout("play(" + timestamp +")", delay);
}

function stop()
{
   document.startstop.src = icon_start;
   timestamp++;
   running = 0;
}
 

function play(mytimestamp)
{
   if(mytimestamp!= timestamp) return;
   if(direction == 1) {
      current_image++;  
   } else {
      current_image--;
   }

   if (current_image >= images.length) {
      if (play_mode == 1) {      
         current_image = 0;
      } else  if (play_mode == 2) {              //sweep mode - change directions (go bkwd)
         current_image = images.length-1;
	 direction=0;
      } else {
         current_image = 0;
      }
   }

   if (current_image < images.length) {
     if (play_mode == 1) {               //rev loop mode - skip to last image
        current_image = images.length-1;
     }
     if (play_mode == 2) {
        current_image = 0;
     }
   }
 
   //== Make sure there is at least one image selected
   //== and find first_selected_image and last_selected_image
   has_selected = false;
   first_selected_image = images.length-1;
   last_selected_image = 0;
   for (var i = 0; i < images.length; i++) {
     if(images[i].ok) { 
       has_selected = true;
       first_selected_image = i < first_selected_image ? i : first_selected_image;  
       last_selected_image = i > last_selected_image ? i : last_selected_image;  
     }
   }

   //== check to ensure that current image has not been deselected from the loop ==
   //== if it has, then find the next image that hasn't been ==
   if(has_selected) {
     while (images[current_image].ok == false) {
         current_image++;
         if (current_image >= images.length) {
            if (play_mode == 1)
               current_image = 0;
            if (play_mode == 2) {
               current_image = images.length-1;
               direction=0;
            }
         }
     }
   } else {
     current_image--;
   }

   displayImage();
   delay_time = delay;
   if (current_image == first_selected_image) delay_time = start_dwell_multipler*delay;
   if (current_image == last_selected_image)   delay_time = end_dwell_multipler*delay;
   setTimeout("play(" +mytimestamp +")", delay_time);
}


function change_speed(dv)
{
   delay+=dv;
   //== check to ensure max and min delay constraints have not been crossed ==
   if(delay > delay_max) delay = delay_max;
   if(delay < delay_min) delay = delay_min;
}
 
function change_end_dwell(dv) {
   end_dwell_multipler+=dv;
   if ( end_dwell_multipler < 1 ) end_dwell_multipler = 0;
}
 
function change_start_dwell(dv) {
   start_dwell_multipler+=dv;
   if ( start_dwell_multipler < 1 ) start_dwell_multipler = 0;
}
 

//===> Increment to next image
function incrementImage(number)
{
   stop();

   //== if image is last in loop, increment to first image ==
   if (number >= images.length) number = 0;
 
   //== Make sure there is at least one image selected
   has_selected = false;
   for (var i = 0; i < images.length; i++) {
     if(images[i].ok) { has_selected = true;}
   }
   if(!has_selected) { return };

   //== check to ensure that image has not been deselected from loop ==
   while (images[number-0].ok == false) {
         number++;
         if (number >= images.length) number =0;
   }
 
   current_image = number;


   displayImage();

}
 
//===> Decrement to next image
function decrementImage(number)
{
   stop();
 
   //== if image is first in loop, decrement to last image ==
   if (number < 0) number = images.length-1;
 
   //== Make sure there is at least one image selected
   has_selected = false;
   for (var i = 0; i < images.length; i++) {
     if(images[i-0].ok) { has_selected = true; }
   }
   if(!has_selected) { return };

   //== check to ensure that image has not been deselected from loop ==
   while (images[number-0].ok == false) {
         number--;
         if (number < 0) number = images.length-1;
   }
 
   current_image = number;
   displayImage();
}




function setImage(number,dir)
{
   stop();
   if (number < 0) number = images.length-1;
   if (number >= images.length) number = 0;

   //== Make sure there is at least one image selected
   has_selected = false;
   for (var i = 0; i < images.length; i++) {
     if(images[i].ok) { has_selected = true; }
   }
   if(!has_selected) { return };

   //== check to ensure that image has not been deselected from loop ==
   while (images[number].ok == false) {
       number+=dir;
       if (number < 0) number = images.length-1;
       else if(number>=images.length) number = 0;
   }
   current_image = number;
   displayImage();
}


function toggle_mode() 
{
   if(play_mode==0) change_mode(1);
   else change_mode(0);
}
 

//===> Change play mode (normal, loop, swing)
function change_mode(mode)
{
   play_mode = mode;
   if(play_mode == 0) {
      document.loopmode.src = modeNormalImage;
  } else {
      document.loopmode.src = modeRockingImage;
   }
}
 
function quote(s) {
   return "\"" + s +"\""
}

function setBoxes() {
    var boxes="";
    var hideboxes = "";
    for (var i = 0; i < images.length; i++)
    {
      gotoalt=alt("Go to image " + i); 
      hidecolor = "blue";
      color = "blue";
      if(images[i].ok==0) {
         hidealt=alt("Use image  " + (i+1) +" in animation"); 
         color = "red";
         hidecolor = "red";
      } else {
         hidealt=alt("Don't use image  " + (i+1) +" in animation"); 
         if(i == current_image) {
             color = "green";
         }
      }
      width=10;
      while(width>2 && images.length*width >500) {
          width--;
      }
      imgAttrs = attr("border",0) + attr("width", width) + attr("height",10);
      box = tag("A", attr2("HREF","JavaScript: noop()", "onClick", call("setImage", i + ",-1")),
                  span(attr("style", "background-color:" + color),img(icon_blank,imgAttrs + gotoalt)))+"&nbsp";
      hidebox = tag("A", attr2("HREF","JavaScript: noop()", "onClick", call("toggleImageOk",i)),
            span(attr("style", "background-color:" + hidecolor),img(icon_blank,imgAttrs + hidealt)))+"&nbsp;";
      boxes+=box;
      hideboxes+=hidebox;
    }

    document.getElementById('boxes').innerHTML =span(attr("style","font-size:10"),boxes);
    document.getElementById('hideboxes').innerHTML =span(attr("style","font-size:10"),hideboxes);

}

function alt(s) {
   return " alt=" + quote(s) +" title=" + quote(s) +" ";
}
function img(path,extra) {
   return "<img " + attr("src", path) + " " + extra +"/>";

}

function call(func, args) {
   return func+"("+args+")";
}

function attr2(name1, value1,name2, value2) { 
   return attr(name1,value1) + " " + attr(name2, value2);
}


function attr(name, value) {
   return " " + name +"="+ quote(value) +" " ;
}

function span(attrs, contents ) {
   return tag("span",  attrs,contents);
}

function tag(tag, attrs, contents ) {
   return "<" + tag +" " + attrs + ">" + contents +"</" + tag +">";
}


 
//===> Check selection status of image in animation loop


function checkImage(status,i)
{
   images[i].ok = status;
   setBoxes();
}

function toggleImageOk(i)
{
   if(images[i].ok==0) images[i].ok=1;
   else images[i].ok=0;
   setBoxes();
}
 
//==> Empty function - used to deal with image buttons rather than HTML buttons
function noop()
{
}
 
//===> Sets up interface - this is the one function called from the HTML body
function animation()
{
  count = 0;
}
 
function goToImage(frame_num)
{
  stop();
  current_image = frame_num;
  displayImage();
}

function displayImage() {
    if(!images[current_image].image) {
         images[current_image].image = new Image();
         images[current_image].image.src = images[current_image].url;
     }
     document.animation.src = images[current_image].url;
     setBoxes();
     if(images[current_image].label) {
          document.getElementById('header').innerHTML = images[current_image].label;
     } else  {
          document.getElementById('header').innerHTML = "";
     }
     
     document.control_form.frameNumber.value = current_image/1+1;
}


// -->
</SCRIPT>

<NOSCRIPT>
<H3>
This requires Javascript for an animation of the imagery.
</H3>
</NOSCRIPT>


<TABLE BORDER="1" CELLPADDING="0" CELLSPACING="0" width="100%" class="imageplayer">
    <TR>
    <TD width="150" align="center" valign="center" > 
<A HREF="JavaScript: noop()" onClick="setImage(0,1)"><IMG  BORDER="0" SRC="${root}/imageplayer/control_rewind_blue.png" ALT="Got to first frame" title="Go to first frame"></A><A HREF="JavaScript: noop()" onClick="setImage(current_image-1,-1)"><IMG  BORDER="0" SRC="${root}/imageplayer/control_start_blue.png" ALT="One step back" TITLE="One step back"></A><A HREF="JavaScript: noop()" onClick="startStop()"><IMG  BORDER="0" NAME="startstop" SRC="${root}/imageplayer/control_play_blue.png" ALT="Start/Stop" TITLE="Start/Stop"></A><A HREF="JavaScript: noop()" onClick="setImage(current_image+1,1)"><IMG  BORDER="0" SRC="${root}/imageplayer/control_end_blue.png" ALT="One step forward" TITLE="One step forward"></A><A HREF="JavaScript: noop()" onClick="setImage(images.length-1,-1)"><IMG  BORDER="0" SRC="${root}/imageplayer/control_fastforward_blue.png" ALT="Go to last frame" TITLE="Go to last frame"></A></TD>
<TD  valign="bottom">
<table  width="100%"><tr valign="bottom">
<td>
<div style="margin-bottom:2" id="hideboxes">&nbsp;</div>
<div id="boxes">&nbsp;</div>
</td>
<FORM METHOD="POST" NAME="control_form" action="javascript:goToImage(document.control_form.frameNumber.value)">
<td width="5%" align="right">
<INPUT TYPE="text" NAME="frameNumber" VALUE=1 SIZE="2" ></INPUT>
</td>
</table>
</TD>
</FORM>
</TR>
<TR VALIGN="top" >
<TD>
<p>
<table cellspacing="0" cellpadding="3">
<tr><td align="right">Loop Mode:</td>
<td>
<A HREF="JavaScript: noop()" onClick="toggle_mode();">
<IMG BORDER=0 name="loopmode" SRC="${root}/imageplayer/button_norm.gif">
</A>
</td></tr>

<tr><td align="right">Adjust Speed:</td>
<td>
<A HREF="JavaScript: noop()" onClick="change_speed(delay_step)"><IMG  BORDER=0  SRC="${root}/imageplayer/bullet_arrow_down.png" ALT="Reduce animation speed" TITLE="Reduce animation speed"></A><A HREF="JavaScript: noop()" onClick="change_speed(-delay_step)"><IMG  BORDER=0  SRC="${root}/imageplayer/bullet_arrow_up.png" ALT="Increase animation speed" TITLE="Increase animation speed"></A>
</td></tr>
<tr><td  align="right">Start Dwell:</td>
<td>
<A HREF="JavaScript: noop()" onClick="change_start_dwell(-dwell_step)"><IMG  BORDER=0  SRC="${root}/imageplayer/bullet_arrow_down.png" ALT="Reduce start dwell" TITLE="Reduce start dwell"></A><A HREF="JavaScript: noop()" onClick="change_start_dwell(dwell_step)"><IMG  BORDER=0  SRC="${root}/imageplayer/bullet_arrow_up.png" ALT="Increase start dwell" TITLE="Increase start dwell"></A>
</td></tr>
<tr><td  align="right">End Dwell:</td>
<td>
<A HREF="JavaScript: noop()" onClick="change_end_dwell(-dwell_step)"><IMG  BORDER=0  SRC="${root}/imageplayer/bullet_arrow_down.png" ALT="Reduce end dwell" TITLE="Reduce end dwell"></A><A HREF="JavaScript: noop()" onClick="change_end_dwell(dwell_step)"><IMG BORDER=0  SRC="${root}/imageplayer/bullet_arrow_up.png" ALT="Increase end dwell" TITLE="Increase end dwell"></A>
</td></tr>
</table>

</TD>
<TD VALIGN=top>
   <div  id="header" style="margin:2">&nbsp;</div>
   <div class="imageblock">
${imagehtml}
   </div>
</TD>
</TR>
</TABLE>

<SCRIPT LANGUAGE="JavaScript">
displayImage();
</SCRIPT>
